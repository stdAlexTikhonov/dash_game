!function(t){var i={};function s(h){if(i[h])return i[h].exports;var e=i[h]={i:h,l:!1,exports:{}};return t[h].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=t,s.c=i,s.d=function(t,i,h){s.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:h})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,i){if(1&i&&(t=s(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var h=Object.create(null);if(s.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var e in t)s.d(h,e,function(i){return t[i]}.bind(null,e));return h},s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="",s(s.s=2)}([function(t,i,s){},,function(t,i,s){"use strict";s.r(i),s.d(i,"stopGame",(function(){return S}));s(0);const h="UP",e="DOWN",r="LEFT",n=" ";let l=2;function o(){let t=1e4*Math.sin(l++);return t-Math.floor(t)}class c{constructor(t,i){this.x=t,this.y=i,this.dir=null,this.EMPTIES=[],this.force=!1}check(t,i){return[n,"*","."].includes(i[t.y][t.x])}check_force_move_left(t){return"O"===t[this.y][this.x-1]&&t[this.y][this.x-2]===n&&this.force}check_force_move_right(t){return"O"===t[this.y][this.x+1]&&t[this.y][this.x+2]===n&&this.force}changeState(t){if(c.off)return!1;switch(this.dir){case h:this.check({x:this.x,y:this.y-1},t)&&(this.y-=1,this.EMPTIES.some(t=>t.x===this.x&&t.y===this.y)||this.EMPTIES.push({x:this.x,y:this.y}));break;case e:this.check({x:this.x,y:this.y+1},t)&&(this.y+=1,this.EMPTIES.some(t=>t.x===this.x&&t.y===this.y)||this.EMPTIES.push({x:this.x,y:this.y}));break;case r:this.check({x:this.x-1,y:this.y},t)?(this.x-=1,this.EMPTIES.some(t=>t.x===this.x&&t.y===this.y)||this.EMPTIES.push({x:this.x,y:this.y})):this.check_force_move_left(t)&&(this.x-=1);break;case"RIGHT":this.check({x:this.x+1,y:this.y},t)?(this.x+=1,this.EMPTIES.some(t=>t.x===this.x&&t.y===this.y)||this.EMPTIES.push({x:this.x,y:this.y})):this.check_force_move_right(t)&&(this.x+=1)}}}c.off=!1,c.flag=!0;class a{constructor(t,i){this.phases="/-\\|",this.phase=0,this.show="/",this.x=i,this.y=t,this.dir_down=!0,this.dir_left=!1,this.dir_up=!1,this.dir_right=!1,this.dir=e,this.flag=!1,this.still_alive=!0}looking_around(t){this.dir_left=t[this.y][this.x-1]===n,this.dir_up=t[this.y-1][this.x]===n,this.dir_right=t[this.y][this.x+1]===n,this.dir_down=t[this.y+1][this.x]===n}find_player(t){const i="A"===t[this.y][this.x-1],s="A"===t[this.y-1][this.x],h="A"===t[this.y][this.x+1];return"A"===t[this.y+1][this.x]||s||i||h}find_rock(t){return"O"===t[this.y-1][this.x]}check_dir(){switch(this.dir){case e:this.dir_left?this.dir=r:this.dir_down?this.dir=e:this.dir_right?this.dir="RIGHT":this.dir=h;break;case"RIGHT":this.dir_down?this.dir=e:this.dir_right?this.dir="RIGHT":this.dir_up?this.dir=h:this.dir=r;break;case h:this.dir_right?this.dir="RIGHT":this.dir_up?this.dir=h:this.dir_left?this.dir=r:this.dir=e;break;case r:this.dir_up?this.dir=h:this.dir_left?this.dir=r:this.dir_down?this.dir=e:this.dir="RIGHT"}}no_way(){return!(this.dir_up||this.dir_down||this.dir_left||this.dir_right)}changeState(t){switch(this.phase=this.phase<3?this.phase+1:0,this.show=this.phases[this.phase],this.flag=!this.flag,(this.find_rock(t)||this.no_way())&&(this.still_alive=!1),this.find_player(t)&&(this.still_alive=!1,c.off=!0),this.flag&&this.looking_around(t),this.flag&&this.check_dir(),this.dir){case e:this.flag&&t[this.y+1][this.x]===n&&(this.y+=1);break;case"RIGHT":this.flag&&t[this.y][this.x+1]===n&&(this.x+=1);break;case h:this.flag&&t[this.y-1][this.x]===n&&(this.y-=1);break;case r:this.flag&&t[this.y][this.x-1]===n&&(this.x-=1)}}}class y{constructor(t,i){this.x=t,this.y=i,this.STARS=[],this.STARS.push(new f(this.y,this.x)),this.STARS.push(new f(this.y-1,this.x)),this.STARS.push(new f(this.y+1,this.x)),this.STARS.push(new f(this.y,this.x-1)),this.STARS.push(new f(this.y,this.x+1)),this.STARS.push(new f(this.y-1,this.x-1)),this.STARS.push(new f(this.y-1,this.x+1)),this.STARS.push(new f(this.y+1,this.x-1)),this.STARS.push(new f(this.y+1,this.x+1))}}class d{constructor(t,i){this.x=i,this.y=t,this.killer=!1,this.falling=!1}check_way_down(t){return this.falling&&"A"===t[this.y+1][this.x]?(this.killer=!0,c.off=!0):this.falling&&"/-|\\".includes(t[this.y+1][this.x])&&(this.killer=!0),this.falling=!0,t[this.y+1][this.x]===n}move_possible(t){return["+","O","*"].includes(t[this.y+1][this.x])}check_way_left(t){return this.falling=!0,t[this.y][this.x-1]===n&&t[this.y+1][this.x-1]===n}check_way_right(t){return this.falling=!0,t[this.y][this.x+1]===n&&t[this.y+1][this.x+1]===n}check_force_move_left(t){return t[this.y][this.x-1]===n&&"A"===t[this.y][this.x+1]}check_force_move_right(t){return t[this.y][this.x+1]===n&&"A"===t[this.y][this.x-1]}changeState(t,i){"A"===t[this.y][this.x]&&(this.killer=!0,c.off=!0),this.check_way_down(t)?this.y+=1:this.check_force_move_left(t)&&i?this.x-=1:this.check_force_move_right(t)&&i?this.x+=1:this.move_possible(t)?this.check_way_left(t)?this.x-=1:this.check_way_right(t)?this.x+=1:this.falling=!1:this.falling=!1}}class f{constructor(t,i){this.x=i,this.y=t,this.still_here=!0,this.falling=!1,this.killer=!1}check_way_down(t){return this.falling&&"A"===t[this.y+1][this.x]?(this.killer=!0,c.off=!0):this.falling&&"/-|\\".includes(t[this.y+1][this.x])&&(this.killer=!0),this.falling=!0,t[this.y+1]&&t[this.y+1][this.x]===n}move_possible(t){return t[this.y+1]&&["+","O","*"].includes(t[this.y+1][this.x])}check_way_left(t){return this.falling=!0,t[this.y][this.x-1]===n&&t[this.y+1][this.x-1]===n}check_way_right(t){return this.falling=!0,t[this.y][this.x+1]===n&&t[this.y+1][this.x+1]===n}changeState(t){"A"===t[this.y][this.x]?this.still_here&&(f.scores+=1,this.still_here=!1):this.check_way_down(t)?this.y+=1:this.move_possible(t)?this.check_way_left(t)?this.x-=1:this.check_way_right(t)?this.x+=1:this.falling=!1:this.falling=!1}}f.scores=0;class x{constructor(t,i,s,h,e,r){this.rand_positions=[],this.height=t,this.width=i,this.minutes=0,this.seconds=0,this.timer=null,this.BREAKS=[];for(let t=0;t<r;t++){const t=this.rndomizer();this.BREAKS.push(t)}this.PREDATORS=[];for(let t=0;t<s;t++){const t=this.rndomizer();this.PREDATORS.push(new a(t.y,t.x))}this.ROCKS=[];for(let t=0;t<h;t++){const t=this.rndomizer();this.ROCKS.push(new d(t.y,t.x))}this.STARS=[];for(let t=0;t<e;t++){const t=this.rndomizer();this.STARS.push(new f(t.y,t.x))}this.GROUND=[];for(let t=0;t<600;t++){const t=this.rndomizer();this.GROUND.push({y:t.y,x:t.x})}const n=this.rndomizer();this.player=new c(n.x,n.y),this.world=this.generate(),this.startTimer()}startTimer(){this.timer=setTimeout(()=>{this.seconds++,this.seconds>59&&(this.seconds=0,this.minutes++),this.startTimer()},1e3)}stopTimer(){clearInterval(this.timer)}getTime(){return(this.minutes<10?"0"+this.minutes:this.minutes)+":"+(this.seconds<10?"0"+this.seconds:this.seconds)}generate(){const t=new Array(this.width).fill("#"),i=new Array(this.width).fill("#"),s=new Array(this.width).fill(n);s[0]="#",s[this.width-1]="#";const h=new Array(this.height);for(let t=0;t<this.height;t++)h[t]=s.slice();return h[0]=t,h[this.height-1]=i,this.GROUND.forEach(t=>h[t.y][t.x]="."),this.player.EMPTIES.forEach(t=>h[t.y][t.x]=n),this.PREDATORS.forEach(t=>h[t.y][t.x]=t.show),this.ROCKS.forEach(t=>h[t.y][t.x]="O"),this.STARS.forEach(t=>h[t.y][t.x]="*"),this.BREAKS.forEach(t=>h[t.y][t.x]="+"),h}rndomizer(){let t=Math.floor(o()*(this.width-2))+1,i=Math.floor(o()*(this.width-2))+1,s={x:t,y:i};for(;this.rand_positions.some(t=>t.x===s.x&&t.y===s.y);)t=Math.floor(o()*(this.width-2))+1,i=Math.floor(o()*(this.width-2))+1,s={x:t,y:i};return this.rand_positions.push(s),s}print(){return this.world.map(t=>t.join(n)).join("\n")+"\nscores: "+f.scores+"  Time: "+this.getTime()}check_predators(){this.PREDATORS.forEach(t=>{if(!t.still_alive){const i=new y(t.x,t.y);this.STARS=this.STARS.concat(i.STARS)}}),this.PREDATORS=this.PREDATORS.filter(t=>t.still_alive)}check_food(){this.STARS=this.STARS.filter(t=>t.still_here)}check_rocks(){this.ROCKS=this.ROCKS.filter(t=>!t.killer)}check_player(){if(c.off&&c.flag){const t=new y(this.player.x,this.player.y);this.STARS=this.STARS.concat(t.STARS),c.flag=!1}else c.flag?this.world[this.player.y][this.player.x]="A":S()}tick(){this.PREDATORS.forEach(t=>t.changeState(this.world)),this.ROCKS.forEach(t=>t.changeState(this.world,this.player.force)),this.STARS.forEach(t=>t.changeState(this.world)),this.player.changeState(this.world),this.check_predators(),this.check_food(),this.check_rocks(),this.world=this.generate(),this.check_player()}}const u=document.createElement("pre");u.style.margin=0;const _=document.createElement("div");document.body.style.display="flex",_.style.margin="auto",_.style.fontFamily="Roboto",_.style.position="relative",_.style.width="460px",_.style.height="470px",_.appendChild(u),document.body.appendChild(_),window.THE_WORLD=null;let p=null;const S=()=>{THE_WORLD.stopTimer(),clearInterval(p),g.style.display="flex",T.innerHTML="Your score: "+f.scores+"<br>Your time: "+THE_WORLD.getTime(),g.appendChild(T)},g=document.createElement("div");g.style.display="flex",g.style.position="absolute",g.style.top=0,g.style.left=0,g.style.width="460px",g.style.height="470px",g.style.flexDirection="column",g.style.justifyContent="center",g.style.backgroundColor="rgba(255,255,255,0.7)";const m=document.createElement("div");m.innerText="PRESS TO START",m.style.border="1px solid lightgreen",m.style.fontSize="25px",m.style.border="1px solid lightgreen",m.style.fontFamily="Tahoma",m.style.fontWeight="bold",m.style.color="lightgreen",m.style.margin="auto",m.style.cursor="pointer",m.style.padding="15px";const T=document.createElement("div");T.style.fontFamily="Tahoma",T.style.fontSize="15px",T.style.margin="auto",g.appendChild(m),_.appendChild(g),m.onclick=()=>{g.style.display="none",THE_WORLD=new x(30,30,3,30,30,100),c.off=!1,c.flag=!0,f.scores=0,p=setInterval(()=>{THE_WORLD.tick(),u.innerText=THE_WORLD.print()},100)}}]);